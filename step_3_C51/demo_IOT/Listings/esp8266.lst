C51 COMPILER V9.54   ESP8266                                                               06/21/2022 18:23:12 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE ESP8266
OBJECT MODULE PLACED IN .\Objects\esp8266.obj
COMPILER INVOKED BY: C:\Keil_v5_51\C51\BIN\C51.EXE esp8266\esp8266.c COMPACT OPTIMIZE(8,SPEED) BROWSE INCDIR(.\uart;.\es
                    -p8266;.\DELAY;.\LCD) DEBUG OBJECTEXTEND PRINT(.\Listings\esp8266.lst) TABS(3) OBJECT(.\Objects\esp8266.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "esp8266.h"
   3          #include "uart.h"
   4          #include "delay.h"
   5          #include <string.h>
   6          #include "LCD1602.h"
   7          #include <INTRINS.H>
   8          char CONNECTED_READY = 0;
   9          char AT_CWMODE[] = "AT+CWMODE=3\r\n"; // 设置为 softAP+station 共存模式
  10          char AT_RST[] = "AT+RST\r\n"; // 重启生效
  11          char AT_CIPMODE[] = "AT+CIPMODE=1\r\n"; // 开启透传模式
  12          char AT_CIPSEND[] = "AT+CIPSEND\r\n"; // 开始透传发送
  13          char AT_CIPMUX[] = "AT+CIPMUX=0\r\n"; // 单连接
  14          char AT_CWJAP[] = "AT+CWJAP=\"xiaozaizi-4c\",\"qwe369gh147\"\r\n";
  15          char AT_CIPSTART[] = "AT+CIPSTART=\"TCP\",\"192.168.28.154\",11111\r\n";
  16          
  17          
  18          // TCP客户端初始化
  19          void Esp8266_Init_Tcp_Client(void)
  20          {
  21   1      
  22   1         USART_SendString(AT_CWMODE);
  23   1         delay_ns(1); // 1s
  24   1         
  25   1         USART_SendString(AT_RST);
  26   1         delay_ns(1); // 1s
  27   1         
  28   1         USART_SendString(AT_CWJAP);
  29   1         delay_ns(6); // 6000ms
  30   1         
  31   1         USART_SendString(AT_CIPMUX);
  32   1         delay_ns(1); // 1000ms
  33   1         
  34   1         USART_SendString(AT_CIPMODE);
  35   1         delay_ns(2); // 2000ms
  36   1         
  37   1         USART_SendString(AT_CIPSTART);
  38   1         delay_ns(6); // 6000ms
  39   1         
  40   1         USART_SendString(AT_CIPSEND);
  41   1         delay_ns(2); // 2000ms
  42   1         
  43   1         CONNECTED_READY = 1;
  44   1      
  45   1      }
  46          
  47          // 8266 发送命令
  48          void Esp8266_Send_Command(char *cmd,char ack,int waittime)
  49          {
  50   1      
  51   1      }
*** WARNING C280 IN LINE 48 OF esp8266\esp8266.c: 'cmd': unreferenced local variable
*** WARNING C280 IN LINE 48 OF esp8266\esp8266.c: 'ack': unreferenced local variable
*** WARNING C280 IN LINE 48 OF esp8266\esp8266.c: 'waittime': unreferenced local variable
C51 COMPILER V9.54   ESP8266                                                               06/21/2022 18:23:12 PAGE 2   

  52          
  53          // TCP客户端链接
  54          void Esp8266_TCP_CLIENT_CONNECT(void)
  55          {
  56   1         USART_SendString(AT_CIPSTART);
  57   1         delay(10);
  58   1      }
  59          
  60          // 多连接
  61          void Esp8266_CIPMUX(void)
  62          {
  63   1         USART_SendString(AT_CIPMUX);
  64   1         delay(10);
  65   1      }
  66          
  67          
  68          // 发送数据 数据被$$包含
  69          void Esp8266_SendData(char *Data){
  70   1         char *AtData = "AT+CIPSEND=$";
  71   1         strcat(AtData,Data);
  72   1         strcat(AtData,"$");
  73   1         USART_SendString(AtData);
  74   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    240    ----
   CONSTANT SIZE    =     15    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =    149      12
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  3 WARNING(S),  0 ERROR(S)
